<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>

  <link rel="icon" href="../assets/favicon.png" type="image/png"/>
  <link rel="stylesheet" href="../styles/styles.css"/>

  <!-- Patch UI v2 -->
  <link rel="stylesheet" href="../css/asd-tabs-override-v2.css?v=2"/>

  <title>Calendario — ASD</title>
</head>
<body>
  <div class="page">
    <a class="back" href="../index.html">← Torna alla home</a>

    <div class="brand">
      <img class="brand-logo" src="../assets/logo.png" alt="Logo ASD Santi Pietro e Paolo" />
      <div class="brand-title">
        <h1>Calendario attività</h1>
        <div class="brand-sub">ASD Santi Pietro e Paolo</div>
      </div>
    </div>

    <div class="card">
      <p>Calendario allenamenti e partite</p>

      <!-- Toolbar locale -->
      <div style="display:flex;gap:8px;flex-wrap:wrap;align-items:center;margin:0 0 12px 0">
        <button class="btn" id="btn-day"    type="button">Vista Giorno (Agenda)</button>
        <button class="btn" id="btn-week"   type="button">Vista Settimana</button>
        <button class="btn" id="btn-month"  type="button">Vista Mese</button>
        <a id="openCalendarFull" class="btn" href="#" style="margin-left:auto">Apri a schermo intero</a>
      </div>

      <!-- Embed responsivo con TAB native abilitate -->
      <div style="position:relative;padding-bottom:56.25%;height:0;overflow:hidden;border-radius:12px">
        <iframe 
          id="calendar-embed"
          src=""
          style="border:0;position:absolute;top:0;left:0;width:100%;height:100%;border-radius:12px;" 
          frameborder="0" scrolling="no">
        </iframe>
      </div>
    </div>
  </div>

  <!-- Modale full-screen -->
  <div id="asd-modal" class="asd-modal" aria-hidden="true">
    <div class="asd-modal__inner">
      <button type="button" class="asd-modal__close" aria-label="Chiudi">✕</button>
      <div class="asd-modal__body"></div>
    </div>
  </div>

  <!-- JS patch v2 -->
  <script src="../js/asd-modal-v2.js?v=2" defer></script>

  <!-- JS locale -->
  <script>
    document.addEventListener('DOMContentLoaded', function () {
      // BASE URL DELL’EMBED con tab/navigazione abilitate
      const BASE = "https://calendar.google.com/calendar/embed";
      const CAL  = "29d83543be0fbbe269fcc9cb7018d6356%40group.calendar.google.com";
      const COMMON = "ctz=Europe%2FRome&showTitle=0&showPrint=0&showTabs=1&showDate=1&showNav=1&showCalendars=0";

      const iframe = document.getElementById('calendar-embed');
      const openBtn = document.getElementById('openCalendarFull');

      // helper per costruire l’URL con la vista desiderata
      function urlFor(mode) {
        // mode: 'AGENDA' (≈Giorno), 'WEEK', 'MONTH'
        return `${BASE}?src=${CAL}&${COMMON}&mode=${mode}`;
      }

      // vista di default: settimana
      iframe.src = urlFor('WEEK');

      // Bottoni di vista
      document.getElementById('btn-day').addEventListener('click',  () => iframe.src = urlFor('AGENDA'));
      document.getElementById('btn-week').addEventListener('click', () => iframe.src = urlFor('WEEK'));
      document.getElementById('btn-month').addEventListener('click', () => iframe.src = urlFor('MONTH'));

      // Modale full screen con stesse viste (parte dalla vista corrente dell’iframe)
      openBtn.addEventListener('click', function (e) {
        e.preventDefault();
        const modal = document.getElementById('asd-modal');
        const body  = modal.querySelector('.asd-modal__body');
        body.innerHTML = `<iframe src="${iframe.src}" width="100%" height="100%" frameborder="0"></iframe>`;
        modal.classList.add('is-open');
        document.documentElement.style.overflow = 'hidden';
      });
    });
  </script>
</body>
</html>

